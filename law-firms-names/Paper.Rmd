---
title: "Spatial Analysis of Russian Law Firm Names"
author: "Pavel Syomin¹"
output:
  word_document:
    reference_doc: "journal-article/reference.docx"
bibliography: "journal-article/refs.bib"
csl: "journal-article/apa.csl"
link-bibliography: False  
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  warning = FALSE, 
  message = FALSE, 
  echo = FALSE, 
  fig.width = 4.96, 
  fig.id = FALSE,
  dpi = 300)
```

```{r imports, cache=TRUE, include=FALSE}
library(here)
source(here("journal-article", "Script.R"))
```

<div custom-style="Affiliation">

¹Perm State University, Geographical faculty, Department of social and economic geography, Perm, Russia; e-mail: ntsp\@ya.ru

</div>

<div custom-style="Abstract">

**Abstract:** the research is focused on integral analysis of law firm names in Russia and its geographical aspects. The main problem of the study is to find out whether several spatial relations between subdivisions of the country, namely neighboring, proximity, and belonging to an economic region, are reflected in law firm naming, and how law firm naming depends on these relations. To conduct the analysis, data about law firm names is extracted from the open dumps of the state small and medium-sized businesses registry. Law firm names are converted into numeric vectors using YandexGPT embeddings, then clustered with KMeans method, and manually grouped to detect main naming strategies. Numeric representations of law firm names within each country's subdivision are averaged to get a regional embedding, and then law firm names of the regions are compared using regional embeddings. It is found out that regions that are geographically closer to each other or have a common border tend to have slightly more similar law firm names. In addition, regions belonging to the same economic region have more similar law firm names either. There are three main law firms naming strategies: form-based, law-based, service-based. Volga and North Caucasus economic regions are characterized by the prevalence of service-based strategy, and Volga-Vyatka economic region has a law-based strategy, while other territories have mixed naming strategies. The results of the study support the existing widely used classification of economic regions in Russia and argue the impact of neighboring, proximity, and links on the economic and cultural properties of the territories. The administrative open data processing techniques, as well as methods of working with firm names based on neural networks proposed in this paper may be used by other economic geographers for their research purposes.

</div>

<div custom-style="Keywords">

**Keywords:** firm names; law firms; text embeddings; economic regions, text similarity.

</div>

# 1. Introduction

The geography of services, also known as the geography of the service sector, is a crucial component of geographical studies in Russia. This field has a history spanning several decades, with origins dating back to the 1960s. The geography of services has two distinct dimensions: economic and social. The former is primarily concerned with the business aspects of the services, while the latter addresses the implications for human well-being arising from the geographical organisation of services [@Tkachenko2016]. The existing scientific literature on the geography of services in Russia covers a broad range of topics, including education [@Shulgina2019], car rental [@Zyrianova2018], catering [@Preobrazhenskiy2018], medical care [@Kazantcev2022; @Panin2023; @Nikoloski2024], and internet access [@Nagirnaya2015; @Zemtsov2022]. However, some areas remain underexplored, with legal services being one such example [@Tkachenko2016; @Moiseeva2016]. 

Despite the lack of interest from geographers, the spatial aspects of the activity of law firms worth investigation for a number of reasons. Firstly, legal services can be categorised as business or producer services, and this category of services is important for economic development, on both a national and regional scale [@Hansen1993; @Faulconbridge2019]. Secondly, despite their comparatively minor direct economic impact, they play a significant role as intermediaries and facilitators, contributing to the establishment and maintenance of the rule of law, social order, stability and predictability of social relations. Thirdly, for the general public, access to legal aid is vital for the protection of human rights and the attainment of social justice. In this regard, the spatial aspects of law services are on a par with the spatial issues of medical care [@Blacksell1988; @Blacksell1990].

The study of firm names — which are sometimes also referred to as company names, brand names or simply “brands” — is a relatively uncommon yet potentially fruitful approach to the geographical analysis of services and related problems. A firm name is designed to distinguish the business from competitors, to highlight the sector or geographical area in which it operates, to convey information about the services offered by a provider and the associated benefits. A brand is therefore capable of transferring a substantial amount of information in a brief textual format. Such information may prove useful in uncovering the city's business landscape and consumer perceptions of a particular city with its distinctive services [@Raento2001]. It may also help to analyze trends common to a specific sector in a geographic region [@Marjavaara2022]. The incorporation of place names (toponyms) in brands influences the business development and consumer attitudes [@Peluso2012; @Zhang2014; @Erdogan2016; @Noorda2019]. Company names encapsulate a multitude of intertwined properties relevant to the economy and culture of a given location. This synthesis makes them suitable for the identification of regions, especially in the case of vernacular regions [@Reed1976; @Liesch2015; @Vukosav2016; @Holtkamp2018].

It seems reasonable to posit that the names of Russian law firms reflect some economic and, to a lesser extent, cultural characteristics of the places where these firms are located. The substantial number of such firms (tens of thousands according to @Moiseeva201) appears to be sufficient for a comprehensive and nuanced representation of areas and territories. It can be hypothesized that there is a geographical variation in the naming of law firms across the country, which is contingent upon a number of factors. The geographical proximity and common borders, for example, should lead to more homogeneous naming practices. Similarly, economic links between places and territories are also expected to reduce the diversity of law firm names. In addition, it may be hypothesized that there are several law firm naming strategies, or typical models of brand construction, that potentially vary across the country. The primary aim of this study is to test these hypotheses.

# 2. Materials and methods

## 2.1. Data

The issue of obtaining information about firm names is a challenging one. All Russian organisations are registered in the state registry operated by the Federal Tax Service (FTS of Russia). An extract from this registry about a particular company can be searched and downloaded online by any person free of charge. However, a considerable sum of money must be paid and a written request submitted to the FTS of Russia to purchase a complete copy of the registry. Commercial companies offer data re-cell services, but the prices are similarly high.

To address these challenges, a unified state registry of small and medium-sized businesses (SMB registry) was used. The registry has been maintained since 2016 in accordance with the Article 4.1 of the Federal Law of 24 July 2007 No. 209-FZ, entitled “On the development of small and medium-sized businesses in the Russian Federation”. All companies and individual entrepreneurs with a yearly revenue below 2 billion roubles and an average yearly number of employees below 250 are automatically included in the SMB registry, without any action being required on their part. The registry is fully downloadable at the FTS open data portal at no cost. Additionally, the portal provides a monthly record of updates made since the registry's inception. To sum it up, the SMB registry can be regarded as the most comprehensive free data source, offering information on Russian business entities, both organisations and individuals.

The downloadable version of the registry includes, in particular, firm names, addresses of registration (up to a settlement), and codes of activity kinds according to the National Classification of Economic Activities (NCAE). It should be noted that the registry does not include large firms, resulting in some data being absent. Nevertheless, the majority of commercial law firms in Russia (in excess of 75%) are classified as small and medium-sized businesses and thus are included in the registry. Consequently, the availability of information is relatively high, and it can be used to draw reliable conclusions.

## 2.2. Methods

### 2.2.1. FTS data processing

SMB registry dumps from FTS website have a large volume (≈200 Gb in total) and a complex structure: each dump is an archive of several thousand XML files, and each XML file contain 900 records with various information about organisations and individuals. Dumps are monthly, resulting in ≈90 archives for the period from 2016 to the present. If unpacked, all archives would occupy more than 2 Tb of disk space, and the extraction and preprocessing of such volume of data would take a large time. It should be noted, though, that the majority of information is redundant for the task in hand, because it is duplicated due to data publication specific (each archive contains a full copy of the registry, and if nothing has changed during the month, the data records will be merely the same) and because only the data about law firms is required, while the registry holds information about all the other firms as well. To extract necessary data from the raw archives, an open-source Python command-line tool was developed named ru-smb-companies. The main stages of data extractions are outlined in the next paragraph, while for the complete information about data processing workflow readers may refer to the source code of the program.

FTS data processing took several steps. First, all source archives available at the time of research (November 2023) were downloaded  from FTS servers and stored both locally and in the cloud. Next, information about law firms was extracted from each archive to a CSV file. Extracted attributes include company or person name, address of incorporation (region, district, city, settlement), taxpayer ID, main activity code and some other properties. After this, CSV tables were combined into one table, deduplicated, and raw addresses were normalized and geocoded to fix the inconsistency in location names and add geographical coordinates. Finally, the resulting table was transformed in a panel view so that each row represents one business entity at a given year. The output table contains data about ≈ 30, 000 law firms for 2016–23. 

### 2.2.2. Firm names processing

A major challenge regarding the methods of this study is the working with names. The objectives of the research imply that names should be grouped and compared in some way. This can easily be accomplished with numbers, but firm names are just short text sequences. Of course, a human can easily say whether two names are similar or not and classify them. However, the human-based approach does not scale well, and the quantity of names requires automation. There are several traditional techniques allowing us to compare text strings. For example, edit distance calculates the number of atomic changed required to turn one string to another, and the edit distance between “cat” and “car” is 1, while the edit distance between “car” and “karst” is 3. Another method named n-gram similarity splits the strings into subsequences, or tokens, and finds the number of common tokens, so that “law company” and “law bureau” are more close to each other than “law bureau” and “juridical center”. Despite their simplicity, they also have a significant disadvantage: they cannot account for the intrinsic variability and flexibility of language and do not consider the meaning of the words and phrases rather than their formal representation. For instance, a human understands that “law company” and “legal organisation” mean almost the same, while edit distance between these strings is high, and n-gram similarity is low. A modern method called text embeddings (sometimes referred to as vectors) can deal with this issue and therefore it is used for this research.

Text embedding, or vector, is a numeric representation of a word, sentence or a document usually designed to catch the meaning of the text. An embedding typically looks like just a sequence of decimals with fixed length, i.e. the count of elements in this sequence does not depend on the length of the input text, so that a short sentence or an entire paragraph are represented as a sequence of, say, 256 numbers. Vectors allow simple computations to find out whether they are more or less similar to each other, and the similarity of vectors corresponds to the similarity of texts. Thus, by computing a mathematical distance between embeddings, one can conclude about the semantic distance between texts. This is right the case of firm names comparison, similarity, and grouping.

There are various methods of obtaining embeddings for different texts, e.g. Word2Vec, GloVe, FastText. The newest GPT-based pretrained large language models such as ChatGPT are also capable of producing text vectors. For this study, embeddings from YandexGPT model were used. These embeddings were obtained for each unique firm name via public API of the model. The vector dimensionality is 256, i.e. each vector is a sequence of 256 numbers. All the concrete hypothesis testing techniques outlined in the next subsection are based on the use of these vectors.

### 2.2.3. Hypothesis testing

To answer Q1, firm names vectors by each region were averaged so that all names of a region are represented with a single vector that equals to the mathematical mean of all firm names vectors within this region. All regions are divided into two groups depending on the presence of common border between them. Pairwise distances between all the regions are calculated, and then median distance between regions in each of two groups is calculated. The results are additionally visualized as a box plot. It is expected that median distance between neighboring regions is smaller than median distance between regions that do not have a same border.

The similar technique is used for Q2. Again, the mean vector of all firm names for each region is computed, and pairwise semantic distance between regions is calculated. Then, a geographical distance between the centroids of regions is also measured. A correlation between geographical distance and semantic distance is computed, and the result is plotted. It is expected that the coefficient of correlation is positive.

Q3 also builds upon the pairwise semantic distances between regions. After these distances are found out, regions are grouped by economic regions. For each economic region, two metrics are calculated: the first is a median distance between regions within this econoimic region, and the second is a median distance between regions within and without this economic region. It is expected that within-median-distance is smaller that beyond-median-distance. The results are additionally illustrated on a boxplot.

Q4 and Q5 follow a slightly different methodics. First, all firm names are clustered with KMeans algorithm (number of clusters is 50). After clustering, a random sample of names from each cluster is taken, and these names are manually checked, described and tagged with the labels of more broad groups. Then these manually defined groups are assigned to names using clusters as links between groups and individual names. The number of names belonging to each group in each region is calculated, and the results of this calculation are mapped on a tile-grid map of Russia to analyze the spatial properties of grouping. In this way, Q4 is processed. For Q5, the regions are marked with the label of the most popular group, and the number of regions with different groups within an economic region is counted. It is expected that each economic regions is characterized with only one majority group. It may be the same as the group for another economic region, but a small if any variation is expected within an economic region to prove its integrity. Also, in general it is expected that there are several clear and meaningful firm naming groups, or naming strategies, and that these groups may have (or not) some clear geographical patterns.

### 2.2.4. Other important considerations

The time range of the source data is from 2016 to 2023. Only the firms that have existed for at least 3 years are included in the analysis. Only organizations are studied, while individual entrepreneurs are omitted, because they do not have firm names. Firm names are preprocessed to remove any parts pointing to the legal form of the business (e.g. limited liability company or public stock company), because these parts are common to the majority of names and thus do not add anything valuable. Law firms are selected by filtering using the following condition: main activity code equals 69.10 (activity in the area of law according to All-Russia Classifier of Kinds of Economic Activity). This filtering technique is derived from @Moiseeva2016. 

# 3. Results and discussion

## 3.1. Semantic distance between heighboring regions is smaller

Figure 1 shows the median semantic distance between law firm names of neighboring regions versus the same of regions that do not have a common border. Despite the difference in medians is relatively small, it does exist, and the overall distribution of values for non-neighboring regions is shifted to the area of higher distances compared to the distribution of values for bordering regions. Thus, the hypothesis from Q1 turns out to be true: neighboring regions are indeed closer to each other in terms of semantic distances between their law firm names.

```{r fig-1-neighbors, fig.cap="Figure 1. The relationship between neightboring status of regions and semantic distance between names of law firms incorporated in these regions", fig.height=3}
neighbor_plot
```

## 3.2. The larger the geographical distance, the larger is semantic distance

Figure 2 shows the continuous analog of Figure 1, i.e. the scatter plot of geographical versus semantic distance between regions according to their law firms names. The observed correlation is weak yet positive. Besides, there are two clusters of points. Thus, for Q2 the answer is partial: there is a positive relationship between the geographical distance and semantic distance of law firm names between regions, but the observed correlation is weak, and also there is a minor group of region pairs that seems to have no such correlation at all.

```{r fig-2-distance-plot, fig.cap="Figure 2. Relationship between geographical distance between regions and semantic distance between names of law firms incorporated in these regions", fig.height=3}
distance_plot
```

## 3.3. Semantic distance within economic regions is smaller

Figure 3 shows the comparison of distances between law firm names within economic regions and outside them. The results are mixed. In some cases, the distance between regions belonging to the same economic region is a bit smaller than the distance between regions belonging to an economic region and other regions that do not belong to this economic region. However, there are several economic regions where this tendency does not holds. In addition, it looks like that the overall shape of semantic distance distributions in these economic regions imply that there are internal subdivisions within this economic region, and thus it seems to be not as united and integral as it is theoretically suggested. This observation has a potential to be quite intriguing for checking the validity of economic regions classification in Russia. Nevertheless, its relative importance in the context of regioning task is quite low, and thus there is no need to make provisions on classification updates right now.

```{r fig-3-economic-regions-distance, fig.cap="Figure 3. Semantic distance between regions within and outside economic regions", fig.height=4}
economic_regions_distances
```

## 3.4. There are three primary naming strategies: form-, field-, service-based

Manual analysis of clustered names samples shows that all the law firm names, except for uncategorized, can be grouped into three generic catgories: form-based, field-based, service-based names. *Form-based names* are focused on the organizational form, or type, of business, company or firm and usually include the words like “company”, “partnership”, “corporation”, “alliance”, “center”, “bureau”. In contrast, *field-based names* point to the field of company's activity, i.e. law, and thus are usually based on law-related words such as “legal”, “juridical”, “lex”. *Service-based names* mention the service nature of the business in general by using words “services” or address the specific kinds of services or areas of related business, e.g. “consulting”, “analytics”, “expertise”, “bankruptcy”, “arbitrazh”, “accounting”, “finance”, “real estate”.  As seen in Figure 4, field-based and service-based naming strategies dominate over form-based, sharing in total more than 80% of all strategical law firm names in the majority of regions. Consequently, all the regions may be divided into two broad groups: either with field-based naming of law firms or with service-based naming of law firms. The spatial patterns of these grouping are nevertheless obscure, with no clear geographical tendencies, and the overall spatial distribution of these naming strategies looks random, except for the prevalence of service-based names in the European South.

```{r fig-4-naming-strategies, fig.cap="Figure 4. Map of naming strategies by regions and economic regions"}
naming_strategies
```

## 3.5. Naming strategies are not consistent over economic regions

From Figure 4 one can easily conclude that few economic regions are characterized by a consistent naming strategy. In Volga-Vyatka region, law-based strategy is the most popular one among all the regions, except for the Republic of Mari El. In Volga and North Caucasus, service-based strategy prevails in the majority of regions. The same also holds for the Eastern Siberia, though the large size of the Krasnoyarsk territory, the only exception, overweights the quantity of regions with service-based stratery, thus the economic region in general can not be treated the same as Volga and North Caucasus. All the other economic regions are characterized by a blend of law firms naming strategies. 

# 4. Conclusion

The results of the research are mixed. On the other hand, several hypothesis have been proven: law firm names in neighboring regions are more similar than law firm names in non-neighboring regions; the smaller the geographic distance between regions, the more similar the law firm names; law firm names within an economic region are typically more similar compared to the law firm names outside an economic regions. On the other hand, the difference in the metrics of similarity is relatively small in all these cases, as well as the correlation coefficient, thus it should be noted that although the hypothesized phenomena do exist, their magnitude is weak.

There are three primary law firm naming strategies: form-based, law-based, service-based. The form-based strategy is in a minority, accounting for ≈10% of all the names. Two other strategies share the remaining majority, and in some regions, law-based naming prevails, while in the others, service-based naming is more common. Service-based law firms naming is a dominant strategy in the majority of regions in the European South of Russia. Other geographical regularities regarding the law firm naming are unclear. Economic regions are typically characterized by a mixture of naming strategies, expect for Volga-Vyatka with dominating law-based strategy, and Volga with North Caucasus with service-based strategy prevailing in the majority of constituting regions.

The contribution of this study is mostly theoretical and methodological. It emphasizes the importance of firm names as the source of information for business- and economy-related research. It also proposes a technique of using modern natural language processing (NLP) solutions based on artificial neural networks for integral analysis of company naming in a geographical context, as well as the usage of disaggregated administrative open data for a spatial analysis. The results argue for the effect of geographical proximity and neighboring on the similarity of economical and (to some extent) cultural properties of the territories. They also generally support the widely used classification of economic regions in Russia, though noticing a few weak places where there is an internal heterogenity within an economic region. The study also offers an example of semi-automated company names classification in a particular field of economic activity and points at some kind of geographical differentiation in the naming strategies, that may be subject to further spatial analysis. 

<div custom-style="References-title">References</div>

<div id="refs"></div>


