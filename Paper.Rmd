---
output:
  word_document:
    reference_doc: assets/reference.docx
bibliography: assets/biblio_ru.bib
csl: "assets/citations-ru.csl"
link-bibliography: false
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  warning = FALSE, 
  message = FALSE, 
  echo = FALSE, 
  fig.width = 6.7, 
  fig.height = 5,
  fig.id = FALSE,
  dpi = 300)
options(knitr.kable.NA = "—")
LOCALE = "ru"
```

```{r imports, cache = TRUE, include = FALSE}
source("helpers/Plots.R")
source("helpers/Stats.R")
source("helpers/Diagram.R")
```

Научная статья

УДК 911.3:33+004.42+004.6

<br>

<div custom-style="Title">

Применение открытых данных налоговой службы для экономико-географического анализа

</div>

<br>

***Аннотация.*** В статье представлена технология для создания геопривязанного табличного набора данных о субъектах малого и среднего предпринимательства (МСП) в России на основе открытых данных Федеральной налоговой службы (ФНС России). Получаемый набор данных охватывает всю территорию России за 2016–2023 гг. Он содержит детализированную до уровня конкретных юридических лиц и индивидуальных предпринимателей информацию о регистрационных номерах, категории, имени или наименовании, месте жительства или местонахождении, виде деятельности, доходах, расходах и численности работников. Статья излагает воспроизводимую методику обработки исходных данных и демонстрирует её применение для получения сведений о фирмах в сфере сельского, лесного хозяйства и рыболовства. Показано, что открытые данные ФНС России с помощью предложенного алгоритма и его реализации на языке программирования Python можно использовать для решения ряда исследовательских задач в области экономической географии, в особенности тех, где требуются дезагрегированные сведения или пространственная детализация до населённых пунктов. Благодаря географическим координатам получаемый набор данных может без дополнительной обработки использоваться для картографирования, а наличие кодов ОКТМО позволяет объединять его с официальными статистическими сведениями.

***Ключевые слова:*** открытые данные, пространственный анализ, геоданные, административные данные, малое и среднее предпринимательство, реестр организаций, Apache Spark, ФНС России

<br>

<div custom-style="Title">

Application of Tax Service Open Data for Analysis in Economic Geography

</div>

<br>

***Abstract.*** The paper features a technology for creating a geo-referenced tabular dataset of small and medium-sized businesses (SMBs) in Russia based on open data from the Federal Tax Service (FTS of Russia). The resulting dataset covers the entire territory of Russia for 2016—2023. It contains information on registration numbers, category, name, address, activity type, income, expenses, and number of employees. The information is detailed up to the specific legal entities or individual entrepreneurs. The article outlines a reproducible methodology for raw data processing and demonstrates its application to obtain a dataset of firms in the agriculture, forestry and fisheries sectors. The paper shows that with the help of proposed technique and its reference implementation on Python programming language, FTS open data can be used to solve various tasks in economical geography, in particular tasks where the disaggregated information or spatial resolution up to settlements is required. In addition, thanks to the geographic coordinates, the generated dataset can be used for mapping without additional processing, and the presence of OKTMO codes allows it to be combined with official statistical information.

***Keywords:*** open data, spatial analysis, spatial data, administrative data, small&medium business, business registry, Apache Spark, FTS of Russia

<br>

# Введение

Современные общественно-географические исследования часто основаны на работе с данными. К таким данным относится, например, агрегированная (сводная) социально-экономическая статистика [@Fedorchenko2017; @Vinogradova2020; @Balina2021], общедоступные сведения социальных сетей и поисковых систем [@Krasnov2020; @Liu2020], геоданные сотовых операторов [@Babkin2020; @Babkin2021; @Vorobyev2021], информация коммерческих систем бизнес-аналитики [@Moiseeva2016; @Kuzminov2021] или геоинформационных сервисов [@Lachininsky2021], спутниковые снимки [@Lachininsky2023]. По объёму, разнообразию и скорости обновления некоторые источники информации приближаются к характеристикам «больших данных» [@Graham2013], использование которых для решения традиционных общественно-географических задач — потенциально перспективное направление [@Blanutsa2017].

Для некоторых экономико-географических важны сведения, детализированные до уровня отдельных фирм. К таким сведениям относятся, например, местонахождение, выручка, расходы, число работников, наименование и другие характеристики. Указанные данные могут использоваться напрямую, как в работах К.В. Ростислава [@Rostislav2021], Е.А. Коломак и А.И. Шерубнёвой [@Kolomak2023], которые анализирует агломерационные эффекты на основе показателей предприятий. Кроме того, на их основе можно считать статистику с произвольной пространственной или временной группировкой. Например, И.С. Гуменюк оперирует подсчётами абсолютного и относительного числа малых и средних предприятий по муниципалитетам Калининградской области [@Gumenyuk2022]; М.А. Саранча включает количество предприятий в интегральный индекс уровня развития малого предпринимательства на территории муниципального образования [@Sarancha2014]; а М.А. Макушин с соавторами использует данные о предприятиях в городах БАМа, чтобы оценить структуру промышленности [@Makushin2023]. Дополнительную важность сведения о конкретных фирмах приобретают при исследованиях в масштабе городов [@Lachininsky2021; @Nikonorov2021; @Kozhevnikov2023], при изучении узких секторов экономики, которые не фигурируют обособленно в статистике [@Moiseeva2016; @Pankratov2023], при анализе отдельно взятой отрасли [@Kuzminov2021].

Удобного источника геопривязанной информации о фирмах в России нет. Исследователи и прикладные специалисты обычно опираются на данные коммерческих (2ГИС, Яндекс-карты) [@Lachininsky2021] или открытых (OpenStreetMap, Wikimapia) геоинформационных сервисов, систем бизнес-аналитики (например, Spark, Контур.Фокус и Ruslana) [@Moiseeva2016; @Kuzminov2021]. Как правило, коммерческие фирмы предоставляют сведения за существенную плату, а для выгрузки и обработки информации открытых ресурсов требуется приложить немало усилий. Формально полный список российских организаций и индивидуальных предпринимателей содержится в двух государственных реестрах (соответственно Едином государственном реестре юридических лиц и Едином государственном реестре индивидуальных предпринимателей), однако ни один из них не распространяется в полном виде — можно лишь извлекать отдельные записи вручную через веб-сервис ФНС России либо автоматизированно за плату через программный интерфейс. Таким образом, актуален вопрос об удобном инструменте, который позволил бы бесплатно и легально получить максимально полный набор геопривязанных данных о российских фирмах.

С недавних пор экономико-географы обратили внимание на такой источник информации, как административные данные ФНС России. 
Для исследований используются, в частности, сведения о доходах физических лиц [@Petrov2021], о налоговых поступлениях в разрезе субъектов федерации или видов экономической деятельности [@Rostislav2020; @Safronov2021], о среднесписочной численности работников организаций [@Rostislav2021], о количестве учтённых жилых помещений [@Lachininsky2021], о количестве малых и средних предприятий и мерах их поддержки [@Gumenyuk2022]. Особое внимание привлекает реестр субъектов малого и среднего предпринимательства (реестр МСП), который регулярно и полностью размещается на сайте службы и содержит сведения о конкретных организациях и индивидуальных предпринимателях, включая адреса регистрации. Де-факто это наиболее полный из открытых наборов сведений о российских фирмах, детализированный до уровня отдельных фирм и геопривязанный хотя бы каким-то образом. Использовать его в исходном виде — непростая задача: выгрузки реестра за несколько лет имеют суммарный сжатый объём 200 Гб и характеризуются сложной многоуровневой структурой, а адреса, записанные в привычном для человека виде, не содержат географических координат или кодов муниципальных образований, в результате чего малопригодны для автоматизированного анализа. Цель работы, проведённой при подготовке данной статьи — упростить использование данных реестра МСП для широкого круга экономико-географов.

В статье предложена технология (алгоритм), позволяющая формировать геопривязанный табличный набор данных о малых и средних фирмах в России. В качестве основы используется реестр субъектов малого и среднего предпринимательства (реестр МСП), размещённый в форме открытых данных на сайте Федеральной налоговой службы России (ФНС России). В отношении субъектов малого и среднего предпринимательства (МСП) набор данных представляет собой генеральную совокупность. Кроме того, в статье обосновывается, что указанный набор данных может использоваться как достаточно репрезентативная выборка для анализа экономики в целом, а не только малого и среднего предпринимательства. Статья сочетает в себе элементы методической работы, data paper и software paper: она подробно описывает исходные данные и воспроизводимый алгоритм (методику) работы с ними, в том числе содержит ссылку на код программы, после чего демонстрирует результат обработки данных на тестовом примере, включая потенциальный вариант разведочного анализа.

# Данные и методы их обработки

Технология опирается на один основной источник исходных данных и несколько вспомогательных источников. Все они являются общедоступными и бесплатными для использования.

**Реестр МСП как основной источник сведений.** Реестр МСП — это государственная информационная система, содержащая информацию о субъектах малого и среднего предпринимательства. Она предусмотрена ст. 4.1 Федерального закона от 24.07.2007 № 209-ФЗ «О развитии малого и среднего предпринимательства в Российской Федерации». Субъекты малого и среднего предпринимательства (субъекты МСП) — это коммерческие юридические лица и индивидуальные предприниматели, соответствующие критериям по доходу, числу работников и некоторым другим показателям. За реестр отвечает ФНС России. Сведения в реестр попадают автоматически, то есть без участия самого субъекта МСП, благодаря чему обеспечивается максимально возможная полнота данных. По закону, сведения реестра ежемесячно размещаются в Интернете и являются общедоступными в течение пяти лет с года опубликования. Норма о реестре появилась в законе в конце 2015 г. На практике реестр размещён на сайте ФНС России в форме открытых данных в виде ежемесячных полных выгрузок, первая из которых датируется августом 2016 г., а последняя доступная на момент подготовки статьи — декабрём 2023 г. (https://www.nalog.gov.ru/opendata/7707329152-rsmp/).

Технически реестр МСП в форме открытых данных — это коллекция zip-архивов xml-файлов. Каждый zip-архив — это «срез» (выгрузка, дамп, dump) реестра на определённую дату. Коллекция zip-архивов тем самым образует временной ряд (time series). Каждый zip-архив содержит множество (обычно 6-7 тысяч) xml-файлов. Каждый xml-файл включает в себя информацию о множестве (обычно ровно 900) субъектов МСП. Один субъект МСП в xml-файле представлен элементом «Документ». Отдельные характеристики субъекта МСП представлены вложенными элементами, атрибутами и значениями в элементе «Документ». К числу таких характеристик относятся ИНН, ОГРН, адрес регистрации, наименование или имя, коды ОКВЭД, вид и категория субъекта МСП, дата включения в реестр и другие.

На момент подготовки статьи (декабрь 2023 г.) было доступно 88 zip-архивов. Их суммарный объём — 193 Гб в сжатом виде и 2.4 Тб в распакованном. Из-за большого объёма исходных данных требуется оптимизировать алгоритм их обработки и использовать специализированные инструменты для работы с «большими данными», о которых будет сказано ниже. При этом проделанные оптимизации позволяют сделать все необходимые вычисления на обычном персональном компьютере, не задействуя облачные платформы.

**Вспомогательные источники.** В дополнение к реестру МСП используются ещё два набора открытых данных ФНС России. Первый — это «Сведения о суммах доходов и расходов по данным бухгалтерской (финансовой) отчетности организаций» (https://www.nalog.gov.ru/opendata/7707329152-revexp/). Он содержит ИНН, суммарные доходы и расходы за год, предшествующий году публикации. Обновляется несколько раз в год, но последующие обновления в течение одного года, по-видимому, представляют собой уточнение ранее опубликованных сведений, поэтому практическая периодичность обновления — это год.  В отличие от реестра МСП, содержит только информацию об организациях, но не об индивидуальных предпринимателях. Технически аналогичен реестру МСП: представляет собой временной ряд zip-архивов xml-файлов, где каждый архив соответствует определённой дате, а каждый xml-файл внутри архива содержит информацию о множестве организаций. Второй — «Сведения о среднесписочной численности работников организации» (https://www.nalog.gov.ru/opendata/7707329152-sshr2019/). Содержит ИНН и среднесписочную численность работников за год, предшествующий году публикации сведений. По остальным характеристикам идентичен предыдущему. Данные обоих наборов доступны с 2019 г. по настоящее время. На момент подготовки статьи на сайте ФНС России была опубликована только последняя версия этого и следующего набора данных. Раньше были доступны предыдущие. Они сохранились в личном архиве автора и доступны по запросу.

Для нормализации адресов, расстановки координат и кодов ОКТМО используются два справочника. Один из них — «Населенные пункты России: численность населения и географические координаты» (https://data.rcsi.science/data-catalog/datasets/160/). Подготовлен проектом «Инфраструктура научно-исследовательских данных» на базе открытых данных Росстата и сведений региональных медицинских информационно-аналитических центров. Содержит перечень городских и сельских населённых пунктов с указанием субъекта федерации и муниципального образования, кода ОКТМО и географических координат. Второй — «Города России» (https://github.com/hflabs/city). Подготовлен компанией «Дадата» на базе собственных разработок. Содержит перечень городских населённых пунктов с информацией о их месте в административно-территориальном делении, коде ОКТМО и географических координатах. Поскольку некоторые населённые пункты в нём отсутствуют, автор статьи добавил их вручную, опираясь на сведения Федеральной информационной адресной системы (ФИАС).

**Методика обработки данных.** Предложенный алгоритм обработки данных состоит из пяти шагов, некоторые из которых разбиты на подзадачи. Он изображён на схеме (рис. 1) и описан ниже. Обозначения в скобках соответствуют обозначениям на схеме.

<br>

```{r fig-1-diagram, fig.cap = "Рис. 1. Схема обработки данных / Fig. 1. Data processing diagram"}
grid::grid.raster(diagram_raster)
```

<br>

Первый шаг — это загрузка данных ФНС России (1). Наборы открытых данных загружаются с сайта ФНС России на устройство пользователя. Загрузка ускоряет дальнейшую обработку. Кроме того, благодаря ей создаётся резервная копия исходных данных, что страхует от риска удаления наборов с сайта налоговой службы. Теоретически возможна загрузка и обработка данных в облачном сервисе, таком как Yandex Cloud.

Второй шаг — фильтрующее извлечение данных (2a). Каждый zip-архив реестра МСП преобразуется в csv-таблицу. Каждая строка таблицы содержит сведения об одном субъекте МСП. Извлекаются следующие характеристики: вид, категория, ИНН, ОГРН, имя или наименование, дата включения в реестр, дата выгрузки сведений в набор открытых данных, юридический адрес (с точностью до населённого пункта), основной код ОКВЭД. При извлечении данные могут фильтроваться по одному или нескольким кодам или группе кодов ОКВЭД. Отфильтрованная таблица будет содержать сведения только из необходимой части реестра МСП, что ускоряет работу и сокращает использование дискового пространства. Реализация данного шага оптимизирована, чтобы уменьшить время обработки, расход оперативной памяти и места для хранения временных файлов: данные из архивов читаются напрямую без распаковки архива целиком, извлекаются и сохраняются только необходимые атрибуты записей о фирмах. Аналогичным образом обрабатываются сведения о доходах, расходах (2b) и о среднесписочной численности работников организаций (2c).

Третий шаг — агрегация данных о субъектах МСП (3a). Таблицы в csv-формате, получившиеся на шаге 2a, сводятся в одну таблицу, из которой удаляются дубли, то есть строки, в которых совпадает набор значимых признаков: ИНН, ОГРН, имя или наименование, вид, категория, код ОКВЭД, адрес регистрации. После удаления дублей в каждой строке проставляются две даты: дата начала действия и дата окончания действия. Эти даты указывают на период, в течение которого актуальна информация, содержащаяся в строке. Например, если организация с 10 августа 2016 г. по 10 марта 2021 г. была известна под одним наименованием, а с 10 апреля 2021 г. — под другим, то в агрегированной таблице она будет представлена двумя строками. У первой дата начала — 10.08.2016, дата окончания — 10.03.2021; у второй дата начала — 10.04.2021, дата окончания — 10.12.2023 (условная дата последнего архива исходных данных). Кроме того, на данном этапе происходят вспомогательные преобразования, цель которых — исправить неточности в исходных данных и корректно определить дубли. Например, в реестре МСП тип населённого пункта может быть указан полностью («город») или сокращённо («г.»), и вспомогательная обработка перед агрегацией позволяет игнорировать такие различия и воспринимать адрес как неизменный. Аналогичным образом производится агрегация и фильтрация данных о доходах, расходах (3b) и агрегация данных о работниках (3c).

Четвёртый шаг — геопривязка субъектов МСП (4). Каждая запись в csv-таблице, полученной на этапе 3a, дополняется кодом ОКТМО и географическими координатами населённого пункта, в котором находится субъект МСП. Для этого используются адрес регистрации и вспомогательные наборы геоданных. Кроме того, исходный адрес в наборе данных заменяется на нормализованный и сохраняется как отдельный атрибут каждый записи в виде структурированной текстовой строки. После нормализации адресов набор данных повторно проверяется на дубли. Дубли, образовавшиеся из-за нормализации адресов, удаляются, а даты актуальности сведений пересчитываются.

Пятый, опциональный шаг — создание панельного представления (5). Таблица, полученная на этапе 4, объединяется с таблицами, полученными на этапах 3b и 3c, и преобразуется в панельный временной ряд, где представлены характеристики каждого субъекта МСП за каждый год с 2016 по 2023. Содержательно такая таблица не отличается от первоначальных, но более удобна для анализа: она одна вместо трёх, и вместо компактного, но не слишком интуитивного и весьма технологизированного формата с датами актуальности информация в ней представлена по годам. Такой вид более привычен для исследователей, а также упрощает объединение набора данных с официальной статистикой, которая также обычно даётся в разрезе календарных лет.

**Характеристики итогового набора данных.** Получаемый набор данных охватывает всю территорию России за период с середины 2016 г. по настоящее время. В зависимости от настроек фильтрации он содержит информацию обо всех субъектах МСП или только о тех, которые ведут деятельность в выбранных сферах. Его пространственное разрешение — до конкретного населённого пункта, временное — до месяца, структурное — до конкретного кода по общероссийскому классификатору видов экономической деятельности (ОКВЭД). Сведения являются дезагрегированными, то есть детализированными до уровня отдельных фирм (организаций и индивидуальных предпринимателей). Помимо структурированных адресов, набор содержит географические координаты населённых пунктов, в которых находятся фирмы, и коды ОКТМО соответствующих муниципальных образований. 

**Технические детали реализации.** Описанный выше алгоритм реализован как набор скриптов на языке программирования Python. Чтение xml осуществляется с помощью высокоэффективной библиотеки lxml. Для агрегации используется система обработки больших данных Apache Spark. Геопривязка и создание панельного представления реализованы с помощью библиотеки Pandas. Исходный код опубликован в личном репозитории автора статьи: https://github.com/PavelSyomin/russian-smb-companies

**Демонстрационный вариант.** С помощью описанного алгоритма был подготовлен пробный набор данных о субъектах МСП, ведущих деятельность в сфере сельского, лесного хозяйства, охоты, рыболовства и рыбоводства. Фильтрация вида деятельности производилась по следующему условию: основной код ОКВЭД организации или предпринимателя находится в группе А классификатора. Использовались исходные данные за весь доступный период: с августа 2016 г. для реестра МСП, с октября 2019 г. для сведений о доходах и расходах организаций; с марта 2020 г. для сведений о среднесписочной численности работников организаций. Описание и визуализация результата приведены в следующем разделе статьи.

# Результаты и обсуждение

**Техническая статистика работы алгоритма.** Время создания демонстрационного набора данных — около 15 часов. Больше всего занимает извлечение информации из архивов (шаг 2). Объём исходных данных — около 200 Гб. Объём итоговых таблиц — 60 Мб; панельного представления — 634 Мб. Итоговый набор данных содержит информацию примерно о `r round(counts[1] / 1000)` тысячах организаций и `r round(counts[2] / 1000)` тысячах индивидуальных предпринимателей.

**Распределение по субъектам федерации.** Нормализованные адреса позволяют агрегировать информацию по субъектам федерации. На рис. 2 представлено количество субъектов МСП, которые вели деятельность в сфере лесного (слева) и сельского (справа) хозяйства в 2021 г. Распределение ожидаемо разное: наибольшее количество фирм в сфере сельского хозяйства расположено в Черноземье и на юге России, также заметны животноводческие регионы; лесное хозяйство сосредоточено на севере европейской части страны, в Восточной Сибири и на Дальнем Востоке.

<br>

```{r fig-2-regions-agri-forest, fig.cap = "Рис. 2. Распределение количества субъектов МСП, ведущих деятельность в сфере сельского и лесного хозяйства, по регионам (субъектам федерации). Цвет — масштабированное количество (0 — минимум, 1 — максимум) / Fig. 2. Regional distribution of SMBs which main activity is agriculture or forestry, in 2021. Color represents the min-max scaled value"}
regions_plot_agri_forestry
```

<br>

В отличие от официальной статистики, получившийся набор данных позволяет проанализировать пространственное распределение с точностью до конкретных видов деятельности, а не крупных агломератов. На рис. 3 показано количество субъектов МСП, ведущих деятельность по выращиванию пшеницы (код 01.11.11) и риса (код 01.12) в 2021 г. Можно заметить, что пространственное распределение фирм отличается и отчасти согласуется с районами выращивания соответствующих культур, хотя вряд ли полностью соответствует ему, так как номинальный код основного вида деятельности не всегда соответствует фактическому.

<br>

```{r fig-3-regions-wheat-rice, fig.cap = "Рис. 3. Распределение количества субъектов МСП, ведущих деятельность по выращиванию пшеницы и риса, по регионам (субъектам федерации). Цвет — масштабированное количество (0 — минимум, 1 — максимум). Серый цвет — отсутствие данных / Fig. 3. Regional distribution of SMBs which main activity is growing of wheat or rice, in 2021. Color represents the min-max scaled value, gray is no data"}
regions_plot_wheat_rice
```

<br>

**Распределение по населённым пунктам.** Набор данных помимо названия субъекта содержит географические координаты, название населённого пункта и территориальной единицы (района, муниципалитета) внутри субъекта. Это позволяет выполнять более детализированные агрегации и показывать их на карте. На рис. 4 показано количество субъектов МСП в населённых пунктах России в 2021 г, а также преимущественная специализация населённых пунктов исходя из того, каких фирм в нём больше всего.

<br>

```{r fig-4-activity-by-settlements-russia, fig.cap = "Рис. 4. Число субъектов МСП по населённым пунктам России и преобладающий вид деятельности. Размер кругов соответствует числу субъектов МСП, цвет — одной из трёх групп видов деятельности по классификатору ОКВЭД (см. легенду) / Fig. 4. Count of SMBs in some Russian settlements with dominant activity type, in 2021. The counts are represented by circle size, and the most popular activity group in the settlement is displayed by color"}
activity_by_settlements
```

<br>

**Отслеживание отдельных фирм.** Набор данных позволяет анализировать изменения у конкретных организаций и предпринимателей, например, «переезд» (изменение адреса регистрации) из одного региона в другой. На рис. 5 показано изменение количества субъектов МСП из пробного набора, зарегистрированных в субъектах России, за весь доступный период.

<br>

```{r fig-5-migrations, fig.cap = "Рис. 5. Распределение количества субъектов МСП из демонстрационного набора, прибывших или покинувших территорию региона (субъекта федерации) за 2016–2023 г. / Fig. 5. Regional distribution of SMBs which have arrived to or left the region during 2016–2023"}
migrations_plot
```

<br>

**Обсуждение.** Предложенный алгоритм имеет техническую ценность: он позволяет обработать большой массив данных, имеющих сложную структуру, и сделать на его основе несколько сравнительно компактных таблиц в формате, который традиционно используется исследователями. Кроме того, технология нормализует адреса, содержащиеся в исходных данных, и обогащает их географическими координатами и кодами ОКТМО, тем самым делая их пригодными для обработки в геоинформационных системах (ГИС) и пространственного анализа в целом, а также упрощая объединение с муниципальной статистикой. Для выполнения алгоритма, несмотря на использование Apache Spark, достаточно персонального компьютера средней конфигурации — использовать облачные вычислительные ресурсы не обязательно. Таким образом, для конечного пользователя технология представляет собой способ работать с big data, обойдя при этом сопутствующие сложности и повышенные требования к ресурсам и навыкам и с помощью нескольких оптимизаций превратив её в работу с обычными «малыми» данными. Благодаря открытому исходному коду и использованию свободного программного обеспечения алгоритм может пригодиться не только пользователям, но и разработчикам как база для создания собственных продуктов.

Набор данных, формируемый с помощью описанной технологии — это информация о генеральной совокупности субъектов МСП в России. Его можно использовать для сплошного исследования малого и среднего предпринимательства в стране. В некотором роде это квази-источник первичных статистических сведений, которые, по общему правилу, относятся к информации ограниченного доступа, но в данном случае являются открытыми в силу прямого указания в Налоговом кодексе.

Технология де-факто позволяет получить полный перечень индивидуальных предпринимателей с именами и адресами (с точностью до населённого пункта). ФНС России не публикует сведения о доходах, расходах и числе работников применительно к индивидуальным предпринимателям, из-за чего исследовательская ценность этих данных меньше, чем информации об организациях. Также следует отметить, что анализ сведений об индивидуальных предпринимателях может рассматриваться как обработка персональных данных физических лиц, что создаёт правовые риски, особенно актуальные в свете регулярного ужесточения юридической ответственности за нарушения в этой сфере.

Вопрос о том, можно ли использовать технологию и создаваемый с её помощью набор данных для изучения не только малого и среднего бизнеса, но и экономики в целом, является сложным. Как отмечалось в обзоре литературы, потребность в данных, детализированных до уровня отдельных фирм, существует, но получить такую информацию сложно или дорого. Может быть, сведений о субъектах МСП будет достаточно, чтобы делать правдоподобные выводы об экономике в целом? На первый взгляд, это разумное предположение, ведь малые и средние предприятия составляют почти 98% в общем числе фирм в России, дают 43% ВВП и обеспечивают занятостью 38% работников [@Barinova2019]. В то же время очевидно, что реестр МСП не является случайной выборкой из генеральной совокупности хозяйствующих субъектов, поскольку его элементы выбраны не случайно, а исходя из ограничений по финансовым показателям и числу занятых. Следовательно, реестр МСП позволяет делать выводы о небольших фирмах, но не позволяет распространить их на все компании. Во всяком случае, такой вывод следует, если оценивать репрезентативность реестра МСП как выборки исходя из процедуры её формирования, то есть рассуждать теоретически. Возможен, однако, и альтернативный, эмпирический путь: чтобы понять, является ли реестр МСП достаточно хорошим «прокси» для генеральной совокупности фирм, надо сравнить распределение фирм в нём с распределением в генеральной совокупности. Обычно при анализе репрезентативности сделать такое сравнение невозможно, поскольку характеристики генеральной совокупности неизвестны. В случае с фирмами в России ситуация другая: статистический регистр Росстата представляет собой относительно полный источник сведений о генеральной совокупности.

Для оценки репрезентативности реестра МСП можно использовать корреляционный анализ. Единая межведомственная информационно-статистическая система (ЕМИСС) содержит данные о числе организаций в разрезе субъектов России и групп ОКВЭД за 2019–2022 гг (https://fedstat.ru/indicator/58109). Такая же статистика рассчитывается на базе реестра МСП. В результате для каждого года, каждого региона и каждой группы ОКВЭД известны два числа: общее количество организаций и количество организаций в реестре МСП. Далее вычисляются коэффициенты корреляции по годам, регионам и группам. Используется ранговый коэффициент корреляции Спирмена, так как он более устойчив к выбросам, чем коэффициент корреляции Пирсона.

Результаты анализа показывают высокую согласованность между числом организаций в целом и числом организаций в реестре МСП. Общий коэффициент корреляции в течение рассмотренных четырёх лет составляет чуть больше 0.8 и мало изменяется (таблица 1). Коэффициенты корреляции по регионам различаются довольно сильно (см. рис. 9), но в основном составляют от 0.7 до 0.9. При анализе отдельных групп ОКВЭД коэффициент корреляции в большинстве случаев не меньше 0.9, а иногда приближается к единице (таблица 2). Лишь три группы характеризуются сравнительно небольшой корреляцией: госуправление (O), образование (P) и экстерриториальная деятельность (U). Это объяснимо, потому что в госуправлении и образовании подавляющее большинство организаций являются государственными или муниципальными (органы власти, подведомственные им учреждения, школы, детские сады, вузы), а количество организаций, ведущих экстерриториальную деятельность, слишком мало, и даже небольшие абсолютные расхождения в числах резко меняют общую картину. Если повторить анализ по годам и регионам, исключив три наиболее «проблемные» группы, то общие коэффициенты корреляции по годам повысятся до 0.94–0.95, а по регионам сместятся в сторону 0.9–1.0. (таблица 1 и рис. 9).

<br>

## Таблица 1

```{r tab-1-corr-by-year}
knitr::kable(
  corr_by_year,
  digits = 2, 
  col.names = c("Год", "$\\rho_{Spearman}$, все группы ОКВЭД", "$\\rho_{Spearman}$, без O, P, U"),
  caption = "Корреляция между числом организаций в реестре МСП и общим числом организаций в каждом регионе(субъекте федерации) в каждой группе деятельности по годам / Correlation between the count of SMB organizations and total count of commercial organizations by year")
```

<br>

```{r fig-6-corr-by-region, fig.cap = "Рис. 6. Распределение регионов (субъектов федерации) по корреляции между числом организаций в реестре МСП и общим числом организаций в каждом году в каждой группе деятельности / Fig. 6. Distribution of regions by the correlation coefficient between the SMB organizations counts and total commercial organizations counts"}
corr_by_region_plot
```

<br>

## Таблица 2

```{r tab-2-corr_by_group}
knitr::kable(
  corr_by_group,
  digits = 2,
  col.names = c("Группа ОКВЭД", "$\\rho_{Spearman}$"),
  caption = "Корреляция между числом организаций в реестре МСП и общим числом организаций в каждом регионе (субъекте федерации) и каждом году по группам деятельности / Correlation between the count of SMB organizations and total count of commercial organizations by activity group")
```

<br>

Таким образом, в большинстве случаев реестр МСП может рассматриваться как достаточно качественная замена полному списку организаций как минимум в двух аспектах: он корректно отражает географическое распределение количества организаций по субъектам России в подавляющем большинстве групп ОКВЭД и структуру экономики по группам ОКВЭД в значительной части субъектов. Это не гарантирует репрезентативность на более низком уровне (конкретные коды ОКВЭД, муниципальные образования, населённые пункты) или по другим характеристикам (число работников, прибыль). Тем не менее, технология позволяет подготовить такой набор данных, который можно использовать — в ряде задач, в отсутствие альтернатив и при дополнительных проверках — не только при изучении малого и среднего предпринимательства как такового, но и при географическом исследовании экономической активности всех организаций. Кроме того, набор данных можно применять для разведочного анализа, по результатам которого искать полные данные для более качественной проверки гипотез.

Ещё одной проблемой является различие между реальным и формальным положением дел. Юридический адрес может отличаться от места ведения деятельности, а ОКВЭД, указанный в документах, может не соответствовать фактической деятельности. Сложности усиливаются из-за того, что расхождения могут проявляться в разной степени в зависимости от расположения и отрасли экономики: так, в особых экономических зонах много номинально зарегистрированных организаций, а место деятельности интернет-компаний вряд ли совпадает с местом нахождения офиса. Вряд ли эту проблему можно решить системно, поэтому технология презюмирует достоверность данных о местонахождении и виде деятельности и не проверяет их. В некоторых случаях объём данных сам по себе снижает эффект от неизбежных расхождений. Если возникают сомнения, то целесообразно выборочно проверить соответствие между номинальным и фактическим положением дел. Для этого можно использовать открытые картографические сервисы, сайты организаций и здравый смысл.

# Выводы

В статье описана технология, позволяющая на основе открытых данных ФНС России создать геопривязанный набор данных о субъектах МСП (организациях и индивидуальных предпринимателях), ведущих деятельность определённого вида. Получаемый набор охватывает период с середины 2016 г. по настоящее время, содержит сведения о регистрационных номерах, наименовании, местонахождении фирмы, её виде и категории, доходах, расходах и числе работников. В пространственном отношении он детализирован до населённых пунктов, во временном — до лет (в части доходов, расходов и числа работников) или месяцев (по остальным характеристикам), в структурном — до кода вида деятельности по ОКВЭД. Местонахождение фирмы указано как нормализованный адрес населённого пункта, его географические координаты и код ОКТМО. Технология реализована на языке программирования Python с использованием свободного программного обеспечения и позволяет обрабатывать большие (несколько терабайт) объёмы исходных данных на компьютере средней конфигурации за разумное время (обычно не более суток).

Технология может использоваться как готовый способ получения данных для экономико-географических исследований или как база для создания производных решений. Поскольку получаемый набор данных представляет собой сплошной геопривязанный перечень субъектов МСП в России за несколько лет, то он может применяться для пространственного и временного анализа малого и среднего предпринимательства. Благодаря относительной репрезентативности реестра МСП по отношению к генеральной совокупности российских фирм в географическом и структурном плане, технология может использоваться как источник данных везде, где требуется геопривязанная информация об экономической активности с детализацией до конкретных организаций или населённых пунктов. Технология позволяет самостоятельно получить данные, аналогичные тем, которые содержатся в коммерческих системах бизнес-аналитики или в картографических сервисах. Поскольку создаваемый набор данных содержит координаты для каждой записи (элемента), то он удобен также для картографической визуализации.

К ограничениям технологии можно отнести неизбежные расхождения между номинальными сведениями, указанными в реестрах, и фактическим положением дел; охват только части фирм, причём не обязательно репрезентативной во всех отношениях; правовые риски при анализе данных об индивидуальных предпринимателях, которые одновременно являются персональными данными. Из-за неполноты адресных баз данных и изменчивости классификатора муниципального деления геопривязка также происходит корректно не во всех случаях. Кроме того, с учётом тенденции к снижению открытости административных данных есть опасность, что исходные наборы данных на сайте ФНС России перестанут быть доступными.

# Литература {-}

<div id="refs"></div>
